pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
-- Blobby Volley clone
-- by HighPerformanceCookie

function _init()
 w = World:create()
 b = Ball:create({31, 31})
 p1 = Blob:create({23, 0}, 0)
 p2 = Blob:create({87, 0}, 1)
end

function _update()
 w:update()
 b:update()
 p1:update()
 p2:update()
end

function _draw()
 cls(1)
 w:draw()
 b:draw()
 p1:draw()
 p2:draw()
end

-->8
-- player blob

Blob = {}
Blob.__index = Blob

function Blob:create(pos, p)
 local blob = {}
 setmetatable(blob, Blob)
 blob.pos = pos
 blob.v = {0, 0}
 blob.sprStand = 0
 blob.p = p or 0
 return blob
end

function Blob:update()
 if (btn(0, self.p)) then self.pos[1] -= 1 end
 if (btn(1, self.p)) then self.pos[1] += 1 end
 if (btn(2, self.p)) then self.pos[2] += 1 end
 if (btn(3, self.p)) then self.pos[2] -= 1 end
 if (btn(4, self.p)) then self:jump() end
 if (btn(5, self.p)) then end

 self.v[2] -= gravity
 self.pos = { 
  mid(0, self.pos[1] + self.v[1], 127), 
  mid(0, self.pos[2] + self.v[2], yMax) }
end

function Blob:jump()
 if (btnp(4, self.p)) then self.v = {0, 3} end
end

function Blob:draw()
 spr(self.sprStand, self.pos[1], 111 - self.pos[2], 2, 2) 
end

-->8
-- ball

Ball = {}
Ball.__index = Ball

function Ball:create(pos)
 local ball = {}
 setmetatable(ball, Ball)
 ball.pos = pos
 ball.v = {0, 0}
 ball.spr = 2
 ball.kickoff = true
 return ball
end

function Ball:update()
 self.v[2] -= gravity
 self.pos = { 
  mid(0, self.pos[1] + self.v[1], 127), 
  mid(0, self.pos[2] + self.v[2], yMax) }
end

function Ball:draw()
 spr(self.spr, self.pos[1], 119 - self.pos[2]) 
end

-->8
-- world

World = {}
World.__index = World

yMax = 500
gravity = 0.2

function World:create(pos)
 local world = {}
 setmetatable(world, World)
 return world
end

function World:update()
end

function World:draw()
 rect(63, 127, 65, 80)
end

-->8
-- utils

__gfx__
00000000000000000077770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000007777777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000007777777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000077770000007777777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000777777000007777777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00007777777700000777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00007777777700000077770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00007777777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00007777777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00007777777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
